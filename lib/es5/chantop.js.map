{"version":3,"sources":["../../babel/src/chantop.js"],"names":["chanTop","vstep","init","$el","list","addClass","empty","chans","load","makeCSS","count","css","_","range","forEach","p","props","has3d","prefix","injector","inject","length","chan","$","buildChan","find","click","installer","toggle","id","append","API","getRates","upd","setInterval","Date","getTime","lastUpdated","interval","is","stahp","clearInterval","updateRatings","data","oldIDs","map","newIDs","difference","document","location","reload","rating","text","arrange","isInstalled","xPlus","addRemove","name","escape","wiki","match","conf","section","_id","ballv","url","sortByOrder","i","attr","arranged","hov","order","oldRating","deltaClass","delta","removeClass","setTimeout","mockRandOrder","rand","Math","random","round","request","getChallenge","captcha","code","vote","lr","handleError","v","act","method","toSend","ajax","type","done","error","handleData","fail","e","hasOwnProperty","rates","Masher","setNewChallenge","challengers","console","log","debug","er","specialErrors","enter_captcha","updateCaptcha","wrong_captcha","force_reload","val","focus","ev","stopPropagation","pool","gradient","catbg","split","pair","left","right","colors","unprefixed","res","exec","rest","without","gradientDirection","ret","gradientType","isNaN","parseFloat","gradientStops","each","main","ajaxSetup","dataType","getJSON","version","initAll","err","default","window","width","unexpand","hasClass","toggleClass","scrollTop","submit","preventDefault","keydown","keyCode","installed","versions","LSfetchJSON","server","myChans","found","mych","push","filter","sync","withVersions","localStorage","JSON","stringify","chid","indicate","xp","ar","install","toInstall","uninstall","removed","remove","alias","existing","getElementById","innerHTML","head","getElementsByTagName","style","createElement","styleSheet","cssText","appendChild","createTextNode","removeChild","getComputedStyle","el","transforms","t","body","insertBefore","getPropertyValue","key","parse","removeItem"],"mappings":"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","file":"chantop.js","sourcesContent":["'use strict';\r\n\r\nvar chanTop = {\r\n\tvstep: 50,\r\n\tinit: function($el, list) {\r\n\t\tthis.$el = $el.addClass('chantop')\r\n\t\tthis.$el.empty()\r\n\t\tthis.chans = list\r\n\t\tthis.load()\r\n\t},\r\n\tmakeCSS: function(count) {\r\n\t\tvar css = '', vstep = this.vstep\r\n\t\t_.range(count).forEach(function(p) {\r\n\t\t\tvar props = ''\r\n\t\t\tif(has3d) {\r\n\t\t\t\t['', '-webkit-'].forEach(function(prefix) {\r\n\t\t\t\t\tprops += `${prefix}transform: translate3d(0, ${vstep*p}px, 0);\\n`\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tprops += `top: ${vstep*p + 10}px;`\r\n\t\t\tcss += `#co-${p} {\\n${props}}\\n`\r\n\t\t})\r\n\t\tcss += `.chantop { height: ${count*vstep}px }`\r\n\t\tinjector.inject('chantop-positions', css)\r\n\t},\r\n\tload: function() {\r\n\t\tthis.makeCSS(this.chans.length)\r\n\t\tthis.chans.forEach(chan => {\r\n\t\t\tchan.$el = $(this.buildChan(chan))\r\n\t\t\tchan.$el.find('.adder-remover').click(() => {\r\n\t\t\t\tinstaller.toggle(chan.id)\r\n\t\t\t})\r\n\t\t\tthis.$el.append(chan.$el)\r\n\t\t})\r\n\t\tAPI.getRates()\r\n\t\tthis.upd = setInterval(() => {\r\n\t\t\tif(new Date().getTime() - this.lastUpdated > this.interval/2 \r\n\t\t\t&& !$('#chantop').is(':hover') \r\n\t\t\t&& $('#chantop').css('visibility') !== 'hidden')\r\n\t\t\t\tAPI.getRates()\r\n\t\t}, this.interval)\r\n\t},\r\n\tstahp: function() {\r\n\t\tclearInterval(this.upd)\r\n\t},\r\n\tupdateRatings: function(data) {\r\n\t\tthis.lastUpdated = new Date().getTime()\r\n\t\tlet oldIDs = _.map(this.chans, 'id')\r\n\t\t, newIDs = _.map(data, 'id')\r\n\t\tif (newIDs.length !== oldIDs.length || _.difference(oldIDs, newIDs).length) {\r\n\t\t\tdocument.location.reload()\r\n\t\t\treturn\r\n\t\t}\r\n\t\tthis.chans.forEach(chan => {\r\n\t\t\tchan.rating = +_.find(data, {id: chan.id}).rating\r\n\t\t\tchan.$el.find('.chan-rating').text(chan.rating)\r\n\t\t})\r\n\t\tthis.arrange()\r\n\t},\r\n\tinterval: 5000,\r\n\tbuildChan: function(chan) {\r\n\t\tlet isInstalled = installer.isInstalled(chan.id)\r\n\t\t, xPlus = isInstalled ? '×' : '+'\r\n\t\t, addRemove = isInstalled ? 'Удалить' : 'Добавить'\r\n\t\t, name = _.escape(chan.name)\r\n\t\t, wiki = (chan.wiki && chan.wiki.match(/https?:\\/\\//)) ? chan.wiki : (conf.wiki+(chan.wiki || name))\r\n\t\treturn html`<div class=\"ct-chan\">\r\n\t\t\t<img src=\"/chans/balls/${chan.section}/${chan.id}.png?uid=${chan._id}${chan.ballv ? `&v=${chan.ballv}` : ''}\" alt=\"${name}\" class=\"chan-avatar\">\r\n\t\t\t<div class=\"catc-addremove adder-remover\" title=\"${addRemove}\">${xPlus}</div>\r\n\t\t\t<a href=\"${_.escape(chan.url)}\" target=\"_blank\" class=\"chan-name\"><span>${name}</span></a>\r\n\t\t\t<div class=\"chan-rating\">${chan.rating}</div>\r\n\t\t\t<div class=\"chan-rating-delta\"></div>\r\n\t\t\t<a target=\"_blank\" href=\"${wiki}\" class=\"catc-info\" title=\"Информация\">i</a>\r\n\t\t</div>`\r\n\t},\r\n\tarrange: function() {\r\n\t\t_.sortByOrder(chanTop.chans, ['rating', 'name'], ['desc', 'asc'])\r\n\t\t.forEach((chan, i) => {\r\n\t\t\tchan.$el.attr('id', `co-${i}`)\r\n\t\t\tif(this.arranged) {\r\n\t\t\t\tvar hov = ' hovering'\r\n\t\t\t\tif(i < chan.order)\r\n\t\t\t\t\thov += ' going-up'\r\n\t\t\t\telse if(i > chan.order)\r\n\t\t\t\t\thov += ' going-down'\r\n\t\t\t\telse\r\n\t\t\t\t\thov = ''\r\n\t\t\t\tif(chan.rating !== chan.oldRating) {\r\n\t\t\t\t\tvar delta = chan.rating - chan.oldRating\r\n\t\t\t\t\t, deltaClass\r\n\t\t\t\t\tif(delta > 0) {\r\n\t\t\t\t\t\tdeltaClass = 'plus'\r\n\t\t\t\t\t\tdelta= '+'+delta\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse \r\n\t\t\t\t\t\tdeltaClass = 'minus'\r\n\t\t\t\t\tchan.$el.find('.chan-rating-delta').text(`${delta}`)\r\n\t\t\t\t\t.removeClass('plus minus').addClass(deltaClass)\r\n\t\t\t\t}\r\n\t\t\t\tchan.$el.addClass(hov+(delta ? ' delta-show' : ''))\r\n\t\t\t\tsetTimeout(() => chan.$el.removeClass('hovering going-down going-up delta-show'), 1000)\r\n\t\t\t}\r\n\t\t\tchan.order = i\r\n\t\t\tchan.oldRating = chan.rating\r\n\t\t})\r\n\t\tthis.arranged = true\r\n\t},\r\n\tarranged: false,\r\n\tmockRandOrder: function(rand) {\r\n\t\trand = rand || 0.3\r\n\t\tthis.chans.forEach(chan => {\r\n\t\t\tif(Math.random() < rand) {\r\n\t\t\t\tchan.rating = Math.round(Math.random() * 1000)\r\n\t\t\t\tchan.$el.find('.chan-rating').text(`${chan.rating}`)\r\n\t\t\t}\r\n\t\t})\r\n\t\tthis.arrange()\r\n\t}\r\n}\r\n\r\nvar API = {\r\n\tgetRates: function() {\r\n\t\tthis.request('rates')\r\n\t},\r\n\tgetChallenge: function() {\r\n\t\tthis.request('challenge')\r\n\t},\r\n\tcaptcha: function(code) {\r\n\t\tthis.request('captcha', 'POST', {captcha: code})\r\n\t},\r\n\tvote: function(lr) {\r\n\t\tif(lr !== 'left' && lr !== 'right')\r\n\t\t\tthis.handleError('You can only vote Left or Right')\r\n\t\tthis.request('vote', 'POST', {v: lr})\r\n\t},\r\n\trequest: function(act, method, toSend) {\r\n\t\t$.ajax({\r\n\t\t\turl: `api.php?act=${act}`,\r\n\t\t\ttype: method || 'GET',\r\n\t\t\tdata: toSend || null,\r\n\t\t}).done(data => {\r\n\t\t\tif(data.error)\r\n\t\t\t\treturn this.handleError(data.error)\r\n\t\t\tthis.handleData(data.data)\r\n\t\t})\r\n\t\t.fail(e => this.handleError('XHR error: ', e))\r\n\t},\r\n\thandleData: function(data) {\r\n\t\tif(data.hasOwnProperty('vote_success')) {\r\n\t\t\t$('body').removeClass('enter-captcha')\r\n\t\t}\r\n\t\tif(data.hasOwnProperty('rates'))\r\n\t\t\tchanTop.updateRatings(data.rates)\r\n\t\tif(data.hasOwnProperty('challengers'))\r\n\t\t\tMasher.setNewChallenge(data.challengers)\r\n\t\tif(data.hasOwnProperty('debug'))\r\n\t\t\tconsole.log(data.debug)\r\n\t},\r\n\thandleError: function(er) {\r\n\t\tif(this.specialErrors.hasOwnProperty(er))\r\n\t\t\tthis.specialErrors[er]()\r\n\t\telse\r\n\t\t\tconsole.error(er)\r\n\t\treturn false\r\n\t},\r\n\tspecialErrors: {\r\n\t\tenter_captcha: function() {\r\n\t\t\t$('body').addClass('enter-captcha')\r\n\t\t\tupdateCaptcha()\r\n\t\t},\r\n\t\twrong_captcha: function() {\r\n\t\t\t$('#captcha-panel').addClass('wrong')\r\n\t\t\tsetTimeout(() => $('#captcha-panel').removeClass('wrong'), 1000)\r\n\t\t\tupdateCaptcha()\r\n\t\t},\r\n\t\tforce_reload: () => document.location.reload()\r\n\t}\r\n}\r\n\r\nfunction updateCaptcha() {\r\n\t$('#cpanel-wrap img').attr('src', '/captcha.php?color=200,200,200')\r\n\t$('input[name=captcha]').val('').focus()\r\n}\r\n\r\nvar Masher = {\r\n\tinit: function($el, list) {\r\n\t\tthis.$el = $el\r\n\t\tvar css = ''\r\n\t\tlist.forEach(chan => {\r\n\t\t\tvar $el = $(this.buildChan(chan))\r\n\t\t\t$el.find('a, .chan-options').click(ev => {\r\n\t\t\t\tev.stopPropagation()\r\n\t\t\t})\r\n\t\t\t$el.find('.adder-remover').click(() => {\r\n\t\t\t\tinstaller.toggle(chan.id)\r\n\t\t\t})\r\n\t\t\tthis.pool[chan.id] = $el\r\n\t\t\tcss += `\\n#ch_${chan.id} {\\n ${this.gradient(chan.catbg)} \\n}`\r\n\t\t})\r\n\t\tinjector.inject('catalog-gradients', css)\r\n\t\t$('.challenger').click(function() {\r\n\t\t\t$('.catalog-chan').addClass('post')\r\n\t\t\tAPI.vote($(this).attr('id').split('c-')[1])\r\n\t\t})\r\n\t\tAPI.getChallenge()\r\n\t},\r\n\tpool: {},\r\n\tbuildChan: chan => {\r\n\t\tlet isInstalled = installer.isInstalled(chan.id)\r\n\t\t, xPlus = isInstalled ? '×' : '+'\r\n\t\t, addRemove = isInstalled ? 'Удалить' : 'Добавить'\r\n\t\t, name = _.escape(chan.name)\r\n\t\t, wiki = (chan.wiki && chan.wiki.match(/https?:\\/\\//)) ? chan.wiki : (conf.wiki+(chan.wiki || name))\r\n\t\treturn html`<div class=\"catalog-chan\">\r\n\t\t  <div class=\"cc-ball-wrap\" id=\"ch_${chan.id}\">\r\n\t\t    <img src=\"/chans/balls/${chan.section}/${chan.id}.png?uid=${chan._id}${chan.ballv ? `&v=${chan.ballv}` : ''}\" alt=\"${name}\" class=\"cc-ball\">\r\n\t\t    <a href=\"${_.escape(chan.url)}\" target=\"_blank\" class=\"channame-overlay\">${name}</a>\r\n\t\t    <div class=\"chan-options co-add adder-remover\" title=\"${addRemove}\">${xPlus}</div>\r\n\t\t    <a href=\"${wiki}\" target=\"_blank\" class=\"chan-options co-info\" title=\"Информация\">i</a>\r\n\t\t  </div>\r\n\t\t</div>`\r\n\t},\r\n\tsetNewChallenge: function(pair) {\r\n\t\tvar [left, right] = pair.map(lr => lr = this.pool[lr.id].addClass('pre').removeClass('post'))\r\n\t\t$('#c-left').append(left)\r\n\t\t$('#c-right').append(right)\r\n\t\tsetTimeout(() => {\r\n\t\t\t$('.challenger .catalog-chan').removeClass('pre')\r\n\t\t}, 500)\r\n\t},\r\n\tgradient: function(colors) {\r\n\t\tlet unprefixed = `linear-gradient(to bottom, #${colors[0]} 0%, #${colors[1]} 100%)`\r\n\t\t, res = /(((?:radial|linear)-gradient)\\((?:(ellipse) at center|(-?[0-9]+)deg|to (right|bottom)), ?(.+)\\));?/i.exec(unprefixed);\r\n\t\tif (res === null) return 'background:' + unprefixed;\r\n\t\tres = _.rest(_.without(res, undefined));\r\n\t\tvar ret = res[0]+'; ';\r\n\t\tvar gradientType = res[1];\r\n\t\tvar gradientDirection;\r\n\t\tif (!isNaN(res[2])) gradientDirection = (90 - parseFloat(res[2])) + 'deg, ';\r\n\t\telse if (res[2] == 'bottom') gradientDirection = 'top, ';\r\n\t\telse if (res[2] == 'right') gradientDirection = 'left, ';\r\n\t\telse gradientDirection = 'center, ellipse cover, ';\r\n\t\tvar gradientStops = res[3];\r\n\t\t_.each(['-o-', '-webkit-', '-moz-'], function(prefix) {\r\n\t\t\tret += 'background:' + prefix + gradientType + '(' + gradientDirection + gradientStops + '); ';\r\n\t\t});\r\n\t\treturn 'background:' + ret;\r\n\t}\r\n}\r\n\r\nfunction main() {\r\n\t$.ajaxSetup({\r\n\t\tdataType: 'json'\r\n\t})\r\n\r\n\t$.getJSON(`/chans/chans.json?v=${new Date().getTime()}`)\r\n\t.done(data => {\r\n\t\tif (data.chans && data.version) {\r\n\t\t\tinitAll(data.chans, data.version)\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconsole.error('bad-json')\r\n\t\t}\r\n\t})\r\n\t.fail(err => console.error(err))\r\n\r\n\thas3d = has3d()\r\n}\r\n\r\nfunction initAll(chans, version) {\r\n\tchans.forEach(chan => {\r\n\t\tchan.section = chan.default ? 'default' : 'custom'\r\n\t})\t\r\n\tinstaller.init(chans, version)\r\n\tchanTop.init($('#chantop'), chans)\r\n\tMasher.init($('#battleground'), chans)\r\n\r\n\t$('header').click(() => {\r\n\t\tif($(window).width() <= 640) {\r\n\t\t\tvar unexpand = $('body').hasClass('xpnd')\r\n\t\t\t$('body').toggleClass('xpnd')\r\n\t\t\tif(!unexpand)\r\n\t\t\t\t$('#battleground-wrap').scrollTop(0)\r\n\t\t}\r\n\t})\r\n\t$('#cpanel-wrap img').click(updateCaptcha)\r\n\t$('#captcha-panel').submit(ev => {\r\n\t\tev.preventDefault()\r\n\t\tAPI.captcha($('input[name=captcha]').val())\r\n\t})\r\n\t$(window).keydown(function(ev) {\r\n\t\tif($('body').hasClass('enter-captcha'))\r\n\t\t\treturn\r\n\t\tif(ev.keyCode == 37 || ev.keyCode == 65)\r\n\t\t\tAPI.vote('left')\r\n\t\tif(ev.keyCode == 39 || ev.keyCode == 68)\r\n\t\t\tAPI.vote('right')\r\n\t})\r\n}\r\n\r\nvar installer = {\r\n\tinstalled: [],\r\n\tinit: function(list, version) {\r\n\t\tthis.list = list\r\n\t\tthis.versions = LSfetchJSON('catalogVersions') || {}\r\n\t\tthis.versions.server = version\r\n\t\tlet myChans = LSfetchJSON('myChans_new')\r\n\t\t, freshList = []\r\n\t\tif (myChans && myChans.length) {\r\n\t\t\tmyChans.forEach(mych => {\r\n\t\t\t\tlet found = _.find(list, {id: mych.id})\r\n\t\t\t\tthis.installed.push(found || mych)\r\n\t\t\t})\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.installed = _.filter(list, {'included': true})\r\n\t\t}\r\n\t\tthis.sync(true)\r\n\t},\r\n\tsync: function(withVersions) {\r\n\t\tlocalStorage['myChans_new'] = JSON.stringify(this.installed)\r\n\t\tif (withVersions) {\r\n\t\t\tlocalStorage['catalogVersions'] = JSON.stringify(this.versions)\r\n\t\t}\r\n\t},\r\n\tisInstalled: function(chid) {\r\n\t\treturn !!_.find(this.installed, {id: chid})\r\n\t},\r\n\tindicate: function(chid, xp, ar) {\r\n\t\t[Masher.pool[chid], _.find(chanTop.chans, {id: chid}).$el].forEach($el => {\r\n\t\t\t$el.find('.adder-remover').text(xp).attr('title', ar)\r\n\t\t})\r\n\t}, \r\n\tinstall: function(chid) {\r\n\t\tlet toInstall = _.find(this.list, {id: chid})\r\n\t\tif (toInstall) {\r\n\t\t\tthis.installed.push(toInstall)\r\n\t\t\tthis.sync()\r\n\t\t\tthis.indicate(chid, '×', 'Удалить')\r\n\t\t}\r\n\t},\r\n\tuninstall: function(chid) {\r\n\t\tvar removed = _.remove(this.installed, {id: chid})\r\n\t\tif (removed) {\r\n\t\t\tthis.sync()\r\n\t\t\tthis.indicate(chid, '+', 'Добавить')\r\n\t\t}\r\n\t},\r\n\ttoggle: function(chid) {\r\n\t\tif(this.isInstalled(chid))\r\n\t\t\tthis.uninstall(chid)\r\n\t\telse\r\n\t\t\tthis.install(chid)\r\n\t}\r\n}\r\n\r\nvar conf = {\r\n\twiki: 'http://wiki.1chan.ca/'\r\n}\r\n\r\nvar injector = {\r\n  inject: function(alias, css) {\r\n    var id = `injector:${alias}`\r\n    var existing = document.getElementById(id)\r\n    if(existing) {\r\n      existing.innerHTML = css\r\n      return\r\n    }\r\n    var head = document.head || document.getElementsByTagName('head')[0]\r\n    , style = document.createElement('style');\r\n    style.type = 'text/css'\r\n    style.id = id\r\n    if (style.styleSheet) {\r\n      style.styleSheet.cssText = css\r\n    } else {\r\n      style.appendChild(document.createTextNode(css))\r\n    }\r\n    head.appendChild(style)\r\n  },\r\n  remove: function(alias) {\r\n    var id = `injector:${alias}`\r\n    var style = document.getElementById(id)\r\n    if(style) {\r\n      var head = document.head || document.getElementsByTagName('head')[0]\r\n      if(head)\r\n        head.removeChild(document.getElementById(id))\r\n    }\r\n  }\r\n}\r\n\r\nfunction has3d() {\r\n  if (!window.getComputedStyle) {\r\n    return false;\r\n  }\r\n  \r\n  var el = document.createElement('p'),\r\n  has3d,\r\n  transforms = {\r\n    'webkitTransform':'-webkit-transform',\r\n    'OTransform':'-o-transform',\r\n    'msTransform':'-ms-transform',\r\n    'MozTransform':'-moz-transform',\r\n    'transform':'transform'\r\n  };\r\n\r\n  // Add it to the body to get the computed style\r\n  document.body.insertBefore(el, null);\r\n\r\n  for(var t in transforms){\r\n    if( el.style[t] !== undefined ){\r\n      el.style[t] = 'translate3d(1px,1px,1px)';\r\n      has3d = window.getComputedStyle(el).getPropertyValue(transforms[t]);\r\n    }\r\n  }\r\n\r\n  document.body.removeChild(el);\r\n\r\n  return (has3d !== undefined && has3d.length > 0 && has3d !== \"none\");\r\n}\r\n\r\nfunction LSfetchJSON(key) {\r\n  let val = null, data = localStorage[key]\r\n  if (typeof data !== 'undefined') {\r\n    try {\r\n      val = JSON.parse(data)\r\n    }\r\n    catch(e) {\r\n      console.error(e)\r\n      localStorage.removeItem(key)\r\n    }\r\n  }\r\n  return val\r\n}"]}